{"ast":null,"code":"import{useState,useEffect}from'react';import{useAuth}from\"../../context_rout\";import{Chat}from'../chat';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export const Home=()=>{const{socketRef}=useAuth();const[mymsg,setmymsg]=useState([]);const[msg,setmsg]=useState('');const[incoming,setincoming]=useState([]);const[users,setUsers]=useState([]);const[connection,setconnection]=useState('');const[req,setreq]=useState([]);useEffect(()=>{if(!socketRef.current)return;// Incoming messages\nconst handleIncoming=msg=>{setincoming(prev=>[...prev,msg]);};socketRef.current.on(\"incoming\",handleIncoming);// Users list\nconst handleUsers=usersList=>{setUsers(usersList);};socketRef.current.on(\"users\",handleUsers);// Connection requests\nconst handleConnectionRequest=_ref=>{let{from}=_ref;setreq(prev=>[...prev,from]);};socketRef.current.on(\"connection-request\",handleConnectionRequest);// Cleanup listeners on unmount\nreturn()=>{socketRef.current.off(\"incoming\",handleIncoming);socketRef.current.off(\"users\",handleUsers);socketRef.current.off(\"connection-request\",handleConnectionRequest);};},[socketRef]);const onmsgChange=e=>{setmsg(e.target.value);};const onSendClick=()=>{if(!socketRef.current)return;if(msg.trim()==='')return;setmymsg(prev=>[...prev,msg]);socketRef.current.emit(\"chat message\",msg);setmsg('');};const onConnectionClick=()=>{if(!socketRef.current)return;socketRef.current.emit(\"request-connection\",{to:connection});};return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"This is chat app\"}),/*#__PURE__*/_jsx(\"input\",{onChange:onmsgChange,value:msg,placeholder:\"Enter your message\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onSendClick,children:\"Send\"}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Enter Username of the person you want to connect to\",onChange:e=>{setconnection(e.target.value);console.log(connection);}}),/*#__PURE__*/_jsx(\"button\",{onClick:onConnectionClick,children:\"Connect\"}),/*#__PURE__*/_jsx(\"div\",{className:\"Users\",children:users.map(user=>/*#__PURE__*/_jsxs(\"div\",{onClick:/*#__PURE__*/_jsx(Chat,{}),children:[user.username,user.self?\" (You)\":\"\"]},user.userID))}),/*#__PURE__*/_jsx(\"div\",{children:req.length>0?req.map((r,i)=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Request From:\"}),/*#__PURE__*/_jsx(\"h4\",{children:r})]},i)):/*#__PURE__*/_jsx(_Fragment,{children:\"No req\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"Messages\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sent\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Sent\"}),mymsg.map((msg,idx)=>/*#__PURE__*/_jsx(\"li\",{children:msg},idx))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"recived\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Recived\"}),incoming.map((msg,idx)=>/*#__PURE__*/_jsx(\"li\",{children:msg},idx))]})]})]});};","map":{"version":3,"names":["useState","useEffect","useAuth","Chat","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Home","socketRef","mymsg","setmymsg","msg","setmsg","incoming","setincoming","users","setUsers","connection","setconnection","req","setreq","current","handleIncoming","prev","on","handleUsers","usersList","handleConnectionRequest","_ref","from","off","onmsgChange","e","target","value","onSendClick","trim","emit","onConnectionClick","to","className","children","onChange","placeholder","onClick","console","log","map","user","username","self","userID","length","r","i","idx"],"sources":["D:/programming/web dev/React/CHATTING/chat-app/src/pages/Home/index.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useAuth } from \"../../context_rout\";\r\nimport { Chat } from '../chat';\r\nexport const Home = () => {\r\n  const { socketRef } = useAuth();\r\n  const [mymsg, setmymsg] = useState([]);\r\n  const [msg, setmsg] = useState('');\r\n  const [incoming, setincoming] = useState([]);\r\n  const [users, setUsers] = useState([]);\r\n  const [connection, setconnection] = useState('');\r\n  const [req, setreq] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (!socketRef.current) return;\r\n\r\n    // Incoming messages\r\n    const handleIncoming = (msg) => {\r\n      setincoming(prev => [...prev, msg]);\r\n    };\r\n    socketRef.current.on(\"incoming\", handleIncoming);\r\n\r\n    // Users list\r\n    const handleUsers = (usersList) => {\r\n      setUsers(usersList);\r\n    };\r\n    socketRef.current.on(\"users\", handleUsers);\r\n\r\n    // Connection requests\r\n    const handleConnectionRequest = ({ from }) => {\r\n      setreq(prev => [...prev, from]);\r\n    };\r\n    socketRef.current.on(\"connection-request\", handleConnectionRequest);\r\n\r\n    // Cleanup listeners on unmount\r\n    return () => {\r\n      socketRef.current.off(\"incoming\", handleIncoming);\r\n      socketRef.current.off(\"users\", handleUsers);\r\n      socketRef.current.off(\"connection-request\", handleConnectionRequest);\r\n    };\r\n  }, [socketRef]);\r\n\r\n  const onmsgChange = (e) => {\r\n    setmsg(e.target.value);\r\n  };\r\n\r\n  const onSendClick = () => {\r\n    if (!socketRef.current) return;\r\n    if (msg.trim() === '') return;\r\n    setmymsg(prev => [...prev, msg]);\r\n    socketRef.current.emit(\"chat message\", msg);\r\n    setmsg('');\r\n  };\r\n\r\n  const onConnectionClick = () => {\r\n    if (!socketRef.current) return;\r\n    socketRef.current.emit(\"request-connection\", { to: connection });\r\n  };\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <h1>This is chat app</h1>\r\n      <input onChange={onmsgChange} value={msg} placeholder='Enter your message' />\r\n      <button onClick={onSendClick}>Send</button>\r\n      <input placeholder='Enter Username of the person you want to connect to' onChange={(e) => {setconnection(e.target.value);console.log(connection)}} />\r\n      <button onClick={onConnectionClick}>Connect</button>\r\n      <div className='Users'>\r\n        {users.map((user) => (\r\n          <div onClick={<Chat/>} key={user.userID}>{user.username}{user.self ? \" (You)\" : \"\"}</div>\r\n        ))}\r\n      </div>\r\n      <div>\r\n        {req.length > 0 ? req.map((r, i) => (\r\n          <div key={i}>\r\n            <h2>Request From:</h2>\r\n            <h4>{r}</h4>\r\n          </div>\r\n        )) : <>No req</>}\r\n      </div>\r\n      <div className='Messages'>\r\n        <div className='sent'>\r\n          <h3>Sent</h3>\r\n          {mymsg.map((msg, idx) => <li key={idx}>{msg}</li>)}\r\n        </div>\r\n        <div className='recived'>\r\n          <h3>Recived</h3>\r\n          {incoming.map((msg, idx) => <li key={idx}>{msg}</li>)}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}